Œªui_demo{
    // UI Application Demonstration in Anarchy Inference
    // This application creates a simple user interface for data visualization
    
    ∆ímain(){
        // Configuration
        œÉtitle = "Anarchy Inference UI Demo";
        Œπwidth = 800;
        Œπheight = 600;
        
        ‚åΩ("Starting " + title);
        
        √∑{
            // Create main window
            Œæwindow = ‚ñ°(title, width, height);
            
            // Load data for visualization
            Œædata = loadData("data/sample_data.csv");
            
            Œπ(!data || data.length === 0){
                ‚åΩ("Error: No data loaded");
                ‚üº(‚ä•);
            }
            
            ‚åΩ("Loaded " + üî§(data.length) + " records");
            
            // Create UI components
            createUI(window, data);
            
            // Start the application
            window.show();
            
            ‚üº(‚ä§);
        }{
            ‚åΩ("Error in UI application: " + ‚ö†.message);
            ‚üº(‚ä•);
        }
    }
    
    // Load data from CSV file
    ∆íloadData(œÉfilePath){
        √∑{
            // Read file content
            œÉcontent = üìñ(filePath);
            
            // Parse CSV data
            Œælines = content.split("\n");
            Œæheader = lines[0].split(",");
            Œædata = ‚àÖ;
            
            // Process each line
            ‚àÄ(lines.slice(1), œÜ(line){
                Œπ(line.trim().length > 0){
                    Œæfields = line.split(",");
                    Œærow = ‚àÖ;
                    
                    ‚àÄ(header, œÜ(col, i){
                        row[col] = fields[i];
                    });
                    
                    Ôºã(data, row);
                }
            });
            
            ‚üº(data);
        }{
            ‚åΩ("Error loading data: " + ‚ö†.message);
            ‚üº(‚àÖ);
        }
    }
    
    // Create the user interface
    ∆ícreateUI(Œæwindow, Œædata){
        // Create header section
        ŒæheaderPanel = window.createPanel("header", 0, 0, width, 80);
        headerPanel.setBackground("#2c3e50");
        
        ŒætitleLabel = headerPanel.createLabel(title, 20, 20, width - 40, 40);
        titleLabel.setFontSize(24);
        titleLabel.setColor("#ffffff");
        
        // Create sidebar for controls
        Œæsidebar = window.createPanel("sidebar", 0, 80, 200, height - 80);
        sidebar.setBackground("#ecf0f1");
        
        // Create visualization area
        ŒævisPanel = window.createPanel("visualization", 200, 80, width - 200, height - 80);
        visPanel.setBackground("#ffffff");
        
        // Add controls to sidebar
        ŒæcategoryLabel = sidebar.createLabel("Select Category:", 10, 20, 180, 30);
        
        // Extract categories from data
        Œæcategories = ‚àÖ;
        ‚àÄ(data, œÜ(row){
            Œπ(!categories.includes(row.category)){
                Ôºã(categories, row.category);
            }
        });
        
        // Create dropdown for categories
        ŒæcategoryDropdown = sidebar.createDropdown(10, 50, 180, 30);
        ‚àÄ(categories, œÜ(category){
            categoryDropdown.addItem(category);
        });
        
        // Create chart type selector
        ŒæchartLabel = sidebar.createLabel("Chart Type:", 10, 100, 180, 30);
        
        ŒæbarChartButton = sidebar.createRadioButton("Bar Chart", 10, 130, 180, 30, ‚ä§);
        ŒæpieChartButton = sidebar.createRadioButton("Pie Chart", 10, 160, 180, 30, ‚ä•);
        ŒælineChartButton = sidebar.createRadioButton("Line Chart", 10, 190, 180, 30, ‚ä•);
        
        // Create update button
        ŒæupdateButton = sidebar.createButton("Update Chart", 10, 240, 180, 40);
        
        // Create export button
        ŒæexportButton = sidebar.createButton("Export Data", 10, 300, 180, 40);
        
        // Initial chart rendering
        renderBarChart(visPanel, data, categories[0]);
        
        // Set up event handlers
        updateButton.onClick(œÜ(){
            œÉselectedCategory = categoryDropdown.getSelectedValue();
            
            Œπ(barChartButton.isSelected()){
                renderBarChart(visPanel, data, selectedCategory);
            }Œµ Œπ(pieChartButton.isSelected()){
                renderPieChart(visPanel, data, selectedCategory);
            }Œµ Œπ(lineChartButton.isSelected()){
                renderLineChart(visPanel, data, selectedCategory);
            }
        });
        
        exportButton.onClick(œÜ(){
            exportData(data, categoryDropdown.getSelectedValue());
        });
    }
    
    // Render bar chart
    ∆írenderBarChart(Œæpanel, Œædata, œÉcategory){
        panel.clear();
        
        // Filter data by selected category
        ŒæfilteredData = data.filter(œÜ(row){ ‚üº(row.category === category); });
        
        // Sort by value
        filteredData.sort(œÜ(a, b){ ‚üº(üî¢(b.value) - üî¢(a.value)); });
        
        // Calculate chart dimensions
        ŒπchartWidth = panel.getWidth() - 80;
        ŒπchartHeight = panel.getHeight() - 100;
        ŒπbarWidth = Math.min(50, chartWidth / filteredData.length - 10);
        
        // Find maximum value for scaling
        ŒπmaxValue = 0;
        ‚àÄ(filteredData, œÜ(row){
            Œπvalue = üî¢(row.value);
            Œπ(value > maxValue){
                maxValue = value;
            }
        });
        
        // Draw chart title
        ŒætitleLabel = panel.createLabel("Bar Chart - Category: " + category, 40, 20, chartWidth, 30);
        titleLabel.setFontSize(18);
        
        // Draw axes
        panel.drawLine(40, 50, 40, 50 + chartHeight, "#000000", 2);
        panel.drawLine(40, 50 + chartHeight, 40 + chartWidth, 50 + chartHeight, "#000000", 2);
        
        // Draw bars
        ‚àÄ(filteredData, œÜ(row, i){
            Œπvalue = üî¢(row.value);
            ŒπbarHeight = (value / maxValue) * chartHeight;
            Œπx = 60 + i * (barWidth + 10);
            Œπy = 50 + chartHeight - barHeight;
            
            // Draw bar
            panel.drawRect(x, y, barWidth, barHeight, "#3498db", ‚ä§);
            
            // Draw label
            panel.drawText(row.name, x, 50 + chartHeight + 15, "#000000", 10);
            
            // Draw value
            panel.drawText(üî§(value), x, y - 15, "#000000", 12);
        });
    }
    
    // Render pie chart
    ∆írenderPieChart(Œæpanel, Œædata, œÉcategory){
        panel.clear();
        
        // Filter data by selected category
        ŒæfilteredData = data.filter(œÜ(row){ ‚üº(row.category === category); });
        
        // Calculate total value
        Œπtotal = 0;
        ‚àÄ(filteredData, œÜ(row){
            total += üî¢(row.value);
        });
        
        // Calculate chart dimensions
        ŒπcenterX = panel.getWidth() / 2;
        ŒπcenterY = panel.getHeight() / 2;
        Œπradius = Math.min(centerX, centerY) - 80;
        
        // Draw chart title
        ŒætitleLabel = panel.createLabel("Pie Chart - Category: " + category, 40, 20, panel.getWidth() - 80, 30);
        titleLabel.setFontSize(18);
        
        // Draw pie slices
        ŒπstartAngle = 0;
        Œæcolors = ["#3498db", "#e74c3c", "#2ecc71", "#f39c12", "#9b59b6", "#1abc9c", "#d35400"];
        
        ‚àÄ(filteredData, œÜ(row, i){
            Œπvalue = üî¢(row.value);
            ŒπsliceAngle = (value / total) * 2 * Math.PI;
            ŒπendAngle = startAngle + sliceAngle;
            
            // Draw slice
            panel.drawArc(centerX, centerY, radius, startAngle, endAngle, colors[i % colors.length], ‚ä§);
            
            // Calculate label position
            ŒπlabelAngle = startAngle + sliceAngle / 2;
            ŒπlabelX = centerX + Math.cos(labelAngle) * (radius * 0.7);
            ŒπlabelY = centerY + Math.sin(labelAngle) * (radius * 0.7);
            
            // Draw label
            panel.drawText(row.name, labelX, labelY, "#ffffff", 12);
            
            // Update start angle for next slice
            startAngle = endAngle;
        });
        
        // Draw legend
        ŒπlegendX = 40;
        ŒπlegendY = panel.getHeight() - 100;
        
        ‚àÄ(filteredData, œÜ(row, i){
            Œπvalue = üî¢(row.value);
            Œπpercentage = (value / total * 100).toFixed(1);
            
            // Draw color box
            panel.drawRect(legendX, legendY + i * 25, 15, 15, colors[i % colors.length], ‚ä§);
            
            // Draw label
            panel.drawText(row.name + ": " + üî§(value) + " (" + percentage + "%)", 
                          legendX + 25, legendY + i * 25 + 12, "#000000", 12);
        });
    }
    
    // Render line chart
    ∆írenderLineChart(Œæpanel, Œædata, œÉcategory){
        panel.clear();
        
        // Filter data by selected category
        ŒæfilteredData = data.filter(œÜ(row){ ‚üº(row.category === category); });
        
        // Sort by ID for line chart
        filteredData.sort(œÜ(a, b){ ‚üº(üî¢(a.id) - üî¢(b.id)); });
        
        // Calculate chart dimensions
        ŒπchartWidth = panel.getWidth() - 80;
        ŒπchartHeight = panel.getHeight() - 100;
        
        // Find maximum value for scaling
        ŒπmaxValue = 0;
        ‚àÄ(filteredData, œÜ(row){
            Œπvalue = üî¢(row.value);
            Œπ(value > maxValue){
                maxValue = value;
            }
        });
        
        // Draw chart title
        ŒætitleLabel = panel.createLabel("Line Chart - Category: " + category, 40, 20, chartWidth, 30);
        titleLabel.setFontSize(18);
        
        // Draw axes
        panel.drawLine(40, 50, 40, 50 + chartHeight, "#000000", 2);
        panel.drawLine(40, 50 + chartHeight, 40 + chartWidth, 50 + chartHeight, "#000000", 2);
        
        // Calculate point spacing
        ŒπpointSpacing = chartWidth / (filteredData.length - 1);
        
        // Draw points and lines
        Œæpoints = ‚àÖ;
        
        ‚àÄ(filteredData, œÜ(row, i){
            Œπvalue = üî¢(row.value);
            Œπx = 40 + i * pointSpacing;
            Œπy = 50 + chartHeight - (value / maxValue) * chartHeight;
            
            // Store point
            Ôºã(points, {x: x, y: y});
            
            // Draw point
            panel.drawCircle(x, y, 5, "#e74c3c", ‚ä§);
            
            // Draw label
            panel.drawText(row.name, x, 50 + chartHeight + 15, "#000000", 10);
            
            // Draw value
            panel.drawText(üî§(value), x, y - 15, "#000000", 12);
            
            // Draw line to previous point
            Œπ(i > 0){
                panel.drawLine(points[i-1].x, points[i-1].y, x, y, "#3498db", 2);
            }
        });
    }
    
    // Export data to CSV file
    ∆íexportData(Œædata, œÉcategory){
        // Filter data by selected category
        ŒæfilteredData = data.filter(œÜ(row){ ‚üº(row.category === category); });
        
        // Create CSV content
        œÉcsvContent = "id,name,value,category\n";
        
        ‚àÄ(filteredData, œÜ(row){
            csvContent += row.id + "," + row.name + "," + row.value + "," + row.category + "\n";
        });
        
        // Save to file
        œÉfileName = "export_" + category + "_" + Date.now() + ".csv";
        ‚úç(fileName, csvContent);
        
        ‚åΩ("Data exported to " + fileName);
    }
}
